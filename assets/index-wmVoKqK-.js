const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Settings-Bb0B-BkV.js","assets/Settings-DrSMNOCs.css","assets/ActionsMenu-DwPXa-7R.js","assets/ActionsMenu-BXOjvYu9.css","assets/UpdatePrompt-C0lvHntI.js","assets/UpdatePrompt-DZu1ZhCf.css"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();const Zt="modulepreload",en=function(e){return"/"+e},lt={},O=function(t,n,i){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),r=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=en(c),c in lt)return;lt[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":Zt,u||(m.as="script"),m.crossOrigin="",m.href=c,r&&m.setAttribute("nonce",r),document.head.appendChild(m),u)return new Promise((h,g)=>{m.addEventListener("load",h),m.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(a){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=a,window.dispatchEvent(r),!r.defaultPrevented)throw a}return s.then(a=>{for(const r of a||[])r.status==="rejected"&&o(r.reason);return t().catch(o)})},b=document.getElementById("img"),ii=document.getElementById("flyingdarkfoxIcon"),ge=document.getElementById("title"),Ne=document.getElementById("author"),U=document.getElementById("progress"),Oe=document.getElementById("miniPlayer"),A=document.getElementById("superInput"),Q=document.getElementById("searchlist"),J=document.getElementById("searchFilters"),E=document.getElementById("playButton"),f=document.querySelector("audio"),se=document.getElementById("actionsMenu"),C=document.getElementById("queuelist"),Ct=document.getElementById("list"),y=document.getElementById("playlist"),tn=document.getElementById("/list"),z=document.getElementById("favButton"),De=z.nextElementSibling,oe=document.getElementById("listTools"),[xt,nn,sn,je,kt,on,at,rn,ln,an]=oe.children,k=document.getElementById("loadingScreen");k.addEventListener("click",()=>k.close());const si=document.getElementById("bitrateSelector"),oi=f.firstElementChild,ri=document.getElementById("subtitleContainer"),li=document.getElementById("subtitleSelector"),cn=document.getElementById("superCollectionSelector"),un="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",Me=(e,t,n="")=>"https://wsrv.nl?url=https://"+(e.startsWith("/")?`yt3.googleusercontent.com${e}=s720-c-k-c0x00ffffff-no-rj&output=webp&w=360`:`i.ytimg.com/vi_webp/${e}/${t}default.webp${n}`);function ye(e){if(e.startsWith("/vi_webp")&&(e=e.slice(9,20)),e.startsWith("/")||e.length===11)return e;e.includes("wsrv.nl")&&(e=e.replace("https://wsrv.nl?url=",""));const t=new URL(e),n=t.pathname;return t.search.includes("ytimg")?n.split("/")[2]:n.split("=")[0]}b.onload=()=>b.naturalWidth===120?b.src=b.src.replace("maxres","mq").replace(".webp",".jpg").replace("vi_webp","vi"):"";b.onerror=()=>b.src.includes("max")?b.src=b.src.replace("maxres","mq").replace(".webp",".jpg").replace("vi_webp","vi"):"";b.src=un;const x=new URL(location.href).searchParams,w=localStorage.getItem.bind(localStorage),l={player:{playbackState:"none",HLS:void 0,hq:!!w("hq"),codec:"opus",supportsOpus:navigator.mediaCapabilities.decodingInfo({type:"file",audio:{contentType:"audio/ogg;codecs=opus"}}).then(e=>e.supported),data:void 0,legacy:!("OffscreenCanvas"in window)},queue:[],stream:{id:x.get("s")||"",title:"",author:"",duration:"",channelUrl:""},streamHistory:[],api:{piped:[],invidious:[],hyperpipe:"https://hyperpipeapi.onrender.com",index:0,unified:0},loadImage:w("imgLoad")||"eager",linkHost:w("linkHost")||location.origin,searchQuery:"",upcomingQuery:"",superCollectionType:"featured",actionsMenu:{id:"",title:"",author:"",duration:"",channelUrl:""},list:{name:"",url:"",type:"",id:"",uploader:"",thumbnail:""},downloadFormat:w("dlFormat")||"opus"};let Bt=()=>{};document.getElementById("moreBtn").addEventListener("click",()=>Bt());async function dn(e){l.stream=e;let t="",n=l.stream.author;e.author.endsWith(" - Topic")&&(t="&w=720&h=720&fit=cover",n=e.author.slice(0,-8));const i={title:e.title,artist:n},s=Me(e.id,"maxres",t);l.loadImage!=="off"&&(b.src=s,i.artwork=[{src:b.src,sizes:"96x96"},{src:b.src,sizes:"128x128"},{src:b.src,sizes:"192x192"},{src:b.src,sizes:"256x256"},{src:b.src,sizes:"384x384"},{src:b.src,sizes:"512x512"}],b.alt=e.title),ge.href=fe(`/watch?v=${e.id}`),ge.textContent=e.title,Ne.textContent=n,Bt=function(){l.actionsMenu=e,se.showModal(),history.pushState({},"","#")},location.pathname==="/"&&(document.title=e.title+" - flyingdarkfox"),"mediaSession"in navigator&&(navigator.mediaSession.setPositionState(),navigator.mediaSession.metadata=new MediaMetadata(i))}const fn=(e,t)=>e===t,ve={equals:fn};let At=Nt;const j=1,be=2,Tt={owned:null,cleanups:null,context:null,owner:null};var I=null;let $e=null,mn=null,v=null,L=null,D=null,Ie=0;function hn(e,t){const n=v,i=I,s=e.length===0,o=t===void 0?i:t,a=s?Tt:{owned:null,cleanups:null,context:o?o.context:null,owner:o},r=s?e:()=>e(()=>V(()=>re(a)));I=a,v=null;try{return ue(r,!0)}finally{v=n,I=i}}function _t(e,t){t=t?Object.assign({},ve,t):ve;const n={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},i=s=>(typeof s=="function"&&(s=s(n.value)),Pt(n,s));return[$t.bind(n),i]}function W(e,t,n){const i=He(e,t,!1,j);ce(i)}function pn(e,t,n){At=vn;const i=He(e,t,!1,j);i.user=!0,D?D.push(i):ce(i)}function ct(e,t,n){n=n?Object.assign({},ve,n):ve;const i=He(e,t,!0,0);return i.observers=null,i.observerSlots=null,i.comparator=n.equals||void 0,ce(i),$t.bind(i)}function V(e){if(v===null)return e();const t=v;v=null;try{return e()}finally{v=t}}function ai(e){pn(()=>V(e))}function $t(){if(this.sources&&this.state)if(this.state===j)ce(this);else{const e=L;L=null,ue(()=>Ee(this),!1),L=e}if(v){const e=this.observers?this.observers.length:0;v.sources?(v.sources.push(this),v.sourceSlots.push(e)):(v.sources=[this],v.sourceSlots=[e]),this.observers?(this.observers.push(v),this.observerSlots.push(v.sources.length-1)):(this.observers=[v],this.observerSlots=[v.sources.length-1])}return this.value}function Pt(e,t,n){let i=e.value;return(!e.comparator||!e.comparator(i,t))&&(e.value=t,e.observers&&e.observers.length&&ue(()=>{for(let s=0;s<e.observers.length;s+=1){const o=e.observers[s],a=$e&&$e.running;a&&$e.disposed.has(o),(a?!o.tState:!o.state)&&(o.pure?L.push(o):D.push(o),o.observers&&Ot(o)),a||(o.state=j)}if(L.length>1e6)throw L=[],new Error},!1)),t}function ce(e){if(!e.fn)return;re(e);const t=Ie;gn(e,e.value,t)}function gn(e,t,n){let i;const s=I,o=v;v=I=e;try{i=e.fn(t)}catch(a){return e.pure&&(e.state=j,e.owned&&e.owned.forEach(re),e.owned=null),e.updatedAt=n+1,Dt(a)}finally{v=o,I=s}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?Pt(e,i):e.value=i,e.updatedAt=n)}function He(e,t,n,i=j,s){const o={fn:e,state:i,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:I,context:I?I.context:null,pure:n};return I===null||I!==Tt&&(I.owned?I.owned.push(o):I.owned=[o]),o}function we(e){if(e.state===0)return;if(e.state===be)return Ee(e);if(e.suspense&&V(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<Ie);)e.state&&t.push(e);for(let n=t.length-1;n>=0;n--)if(e=t[n],e.state===j)ce(e);else if(e.state===be){const i=L;L=null,ue(()=>Ee(e,t[0]),!1),L=i}}function ue(e,t){if(L)return e();let n=!1;t||(L=[]),D?n=!0:D=[],Ie++;try{const i=e();return yn(n),i}catch(i){n||(D=null),L=null,Dt(i)}}function yn(e){if(L&&(Nt(L),L=null),e)return;const t=D;D=null,t.length&&ue(()=>At(t),!1)}function Nt(e){for(let t=0;t<e.length;t++)we(e[t])}function vn(e){let t,n=0;for(t=0;t<e.length;t++){const i=e[t];i.user?e[n++]=i:we(i)}for(t=0;t<n;t++)we(e[t])}function Ee(e,t){e.state=0;for(let n=0;n<e.sources.length;n+=1){const i=e.sources[n];if(i.sources){const s=i.state;s===j?i!==t&&(!i.updatedAt||i.updatedAt<Ie)&&we(i):s===be&&Ee(i,t)}}}function Ot(e){for(let t=0;t<e.observers.length;t+=1){const n=e.observers[t];n.state||(n.state=be,n.pure?L.push(n):D.push(n),n.observers&&Ot(n))}}function re(e){let t;if(e.sources)for(;e.sources.length;){const n=e.sources.pop(),i=e.sourceSlots.pop(),s=n.observers;if(s&&s.length){const o=s.pop(),a=n.observerSlots.pop();i<s.length&&(o.sourceSlots[a]=i,s[i]=o,n.observerSlots[i]=a)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)re(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)re(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function bn(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function Dt(e,t=I){throw bn(e)}function qt(e,t){return V(()=>e(t||{}))}const wn=e=>`Stale read from <${e}>.`;function Ft(e){const t=e.keyed,n=ct(()=>e.when,void 0,{equals:(i,s)=>t?i===s:!i==!s});return ct(()=>{const i=n();if(i){const s=e.children;return typeof s=="function"&&s.length>0?V(()=>s(t?i:()=>{if(!V(n))throw wn("Show");return e.when})):s}return e.fallback},void 0,void 0)}function En(e,t,n){let i=n.length,s=t.length,o=i,a=0,r=0,c=t[s-1].nextSibling,u=null;for(;a<s||r<o;){if(t[a]===n[r]){a++,r++;continue}for(;t[s-1]===n[o-1];)s--,o--;if(s===a){const d=o<i?r?n[r-1].nextSibling:n[o-r]:c;for(;r<o;)e.insertBefore(n[r++],d)}else if(o===r)for(;a<s;)(!u||!u.has(t[a]))&&t[a].remove(),a++;else if(t[a]===n[o-1]&&n[r]===t[s-1]){const d=t[--s].nextSibling;e.insertBefore(n[r++],t[a++].nextSibling),e.insertBefore(n[--o],d),t[s]=n[o]}else{if(!u){u=new Map;let m=r;for(;m<o;)u.set(n[m],m++)}const d=u.get(t[a]);if(d!=null)if(r<d&&d<o){let m=a,h=1,g;for(;++m<s&&m<o&&!((g=u.get(t[m]))==null||g!==d+h);)h++;if(h>d-r){const te=t[a];for(;r<d;)e.insertBefore(n[r++],te)}else e.replaceChild(n[r++],t[a++])}else a++;else t[a++].remove()}}}const ut="_$DX_DELEGATE";function X(e,t,n,i={}){let s;return hn(o=>{s=o,t===document?e():_(t,e(),t.firstChild?null:void 0,n)},i.owner),()=>{s(),t.textContent=""}}function de(e,t,n){let i;const s=()=>{const a=document.createElement("template");return a.innerHTML=e,a.content.firstChild},o=()=>(i||(i=s())).cloneNode(!0);return o.cloneNode=o,o}function ci(e,t=window.document){const n=t[ut]||(t[ut]=new Set);for(let i=0,s=e.length;i<s;i++){const o=e[i];n.has(o)||(n.add(o),t.addEventListener(o,Ln))}}function S(e,t,n){n==null?e.removeAttribute(t):e.setAttribute(t,n)}function qe(e,t){t==null?e.removeAttribute("class"):e.className=t}function ui(e,t,n,i){if(i)Array.isArray(n)?(e[`$$${t}`]=n[0],e[`$$${t}Data`]=n[1]):e[`$$${t}`]=n;else if(Array.isArray(n)){const s=n[0];e.addEventListener(t,n[0]=o=>s.call(e,n[1],o))}else e.addEventListener(t,n,typeof n!="function"&&n)}function Sn(e,t,n){return V(()=>e(t,n))}function _(e,t,n,i){if(n!==void 0&&!i&&(i=[]),typeof t!="function")return Se(e,t,i,n);W(s=>Se(e,t(),s,n),i)}function Ln(e){let t=e.target;const n=`$$${e.type}`,i=e.target,s=e.currentTarget,o=c=>Object.defineProperty(e,"target",{configurable:!0,value:c}),a=()=>{const c=t[n];if(c&&!t.disabled){const u=t[`${n}Data`];if(u!==void 0?c.call(t,u,e):c.call(t,e),e.cancelBubble)return}return t.host&&typeof t.host!="string"&&!t.host._$host&&t.contains(e.target)&&o(t.host),!0},r=()=>{for(;a()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}}),e.composedPath){const c=e.composedPath();o(c[0]);for(let u=0;u<c.length-2&&(t=c[u],!!a());u++){if(t._$host){t=t._$host,r();break}if(t.parentNode===s)break}}else r();o(i)}function Se(e,t,n,i,s){for(;typeof n=="function";)n=n();if(t===n)return n;const o=typeof t,a=i!==void 0;if(e=a&&n[0]&&n[0].parentNode||e,o==="string"||o==="number"){if(o==="number"&&(t=t.toString(),t===n))return n;if(a){let r=n[0];r&&r.nodeType===3?r.data!==t&&(r.data=t):r=document.createTextNode(t),n=Y(e,n,i,r)}else n!==""&&typeof n=="string"?n=e.firstChild.data=t:n=e.textContent=t}else if(t==null||o==="boolean")n=Y(e,n,i);else{if(o==="function")return W(()=>{let r=t();for(;typeof r=="function";)r=r();n=Se(e,r,n,i)}),()=>n;if(Array.isArray(t)){const r=[],c=n&&Array.isArray(n);if(Fe(r,t,n,s))return W(()=>n=Se(e,r,n,i,!0)),()=>n;if(r.length===0){if(n=Y(e,n,i),a)return n}else c?n.length===0?dt(e,r,i):En(e,n,r):(n&&Y(e),dt(e,r));n=r}else if(t.nodeType){if(Array.isArray(n)){if(a)return n=Y(e,n,i,t);Y(e,n,null,t)}else n==null||n===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);n=t}}return n}function Fe(e,t,n,i){let s=!1;for(let o=0,a=t.length;o<a;o++){let r=t[o],c=n&&n[e.length],u;if(!(r==null||r===!0||r===!1))if((u=typeof r)=="object"&&r.nodeType)e.push(r);else if(Array.isArray(r))s=Fe(e,r,c)||s;else if(u==="function")if(i){for(;typeof r=="function";)r=r();s=Fe(e,Array.isArray(r)?r:[r],Array.isArray(c)?c:[c])||s}else e.push(r),s=!0;else{const d=String(r);c&&c.nodeType===3&&c.data===d?e.push(c):e.push(document.createTextNode(d))}}return s}function dt(e,t,n=null){for(let i=0,s=t.length;i<s;i++)e.insertBefore(t[i],n)}function Y(e,t,n,i){if(n===void 0)return e.textContent="";const s=i||document.createTextNode("");if(t.length){let o=!1;for(let a=t.length-1;a>=0;a--){const r=t[a];if(s!==r){const c=r.parentNode===e;!o&&!a?c?e.replaceChild(s,r):e.insertBefore(s,n):c&&r.remove()}else o=!0}}else e.insertBefore(s,n);return[s]}var In=de("<img crossorigin=anonymous>"),Cn=de("<p class=duration>"),xn=de("<a><span></span><div class=metadata><p class=title></p><div class=avu><p class=author></p><p class=viewsXuploaded></p></div></div><i>");function Qe(e){const[t,n]=_t(""),i=l.loadImage==="off"?void 0:l.loadImage;let s;function o(r){const c=r.target,u=t();if(c.naturalWidth!==120){s.classList.remove("ravel");return}u.includes("webp")?n(u.replace(".webp",".jpg").replace("vi_webp","vi")):(s.classList.add("delete"),s.click())}function a(){const r=t();n(r.includes("vi_webp")?r.replace(".webp",".jpg").replace("vi_webp","vi"):"/logo192.png"),s.classList.remove("ravel")}return i&&n(Me(e.img||e.id,"mq")),(()=>{var r=xn(),c=r.firstChild,u=c.nextSibling,d=u.firstChild,m=d.nextSibling,h=m.firstChild,g=h.nextSibling,te=u.nextSibling,F=s;return typeof F=="function"?Sn(F,r):s=r,qe(r,"streamItem "+(i?"ravel":"")),_(c,qt(Ft,{when:i,get fallback(){return e.duration},get children(){return[(()=>{var p=In();return p.addEventListener("load",o),p.addEventListener("error",a),S(p,"loading",i),W(()=>S(p,"src",t())),p})(),(()=>{var p=Cn();return _(p,()=>e.duration),p})()]}})),_(d,()=>e.title),_(h,()=>e.author.replace(" - Topic","")),_(g,()=>(e.views||"")+(e.uploaded?" â€¢ "+e.uploaded.replace("Streamed ",""):"")),W(p=>{var Ze=e.href,et=e.id,tt=e.title,nt=e.author,it=e.channelUrl,st=e.duration,ot=t(),rt=`ri-${e.draggable?"draggable":"more-2-fill"}`;return Ze!==p.e&&S(r,"href",p.e=Ze),et!==p.t&&S(r,"data-id",p.t=et),tt!==p.a&&S(r,"data-title",p.a=tt),nt!==p.o&&S(r,"data-author",p.o=nt),it!==p.i&&S(r,"data-channel_url",p.i=it),st!==p.n&&S(r,"data-duration",p.n=st),ot!==p.s&&S(r,"data-thumbnail",p.s=ot),rt!==p.h&&qe(te,p.h=rt),p},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),r})()}const We=["discover","history","favorites","listenLater","channels","playlists"],T=()=>JSON.parse(localStorage.getItem("library")||"{}"),q=e=>Be("library",JSON.stringify(e)),kn=e=>document.getElementById(e).lastElementChild;function Ut(e,t){var i;if(!e)return;const n=T();delete n[e][t],(i=y.querySelector(`[data-id="${t}"]`))==null||i.remove(),q(n)}function Ce(e,t,n){if(!e)return;const i=t.id;n.hasOwnProperty(e)?n[e].hasOwnProperty(i)&&delete n[e][i]:n[e]={},n[e][i]=t}function Rt(e,t){if(!e)return;const n=T();Ce(e,t,n),q(n)}function Bn(e,t,n=T()){if(e){for(const i in t){const s=t[i];Ce(e,s,n)}q(n)}}function An(e){const t=document.getElementById("collectionSelector");We.concat([...t.options].slice(2).map(n=>n.value)).includes(e)?$("This Playlist Already Exists!"):t.add(new Option(e,e))}function ft(e,t){for(const n in e){const i=e[n];i.id&&X(()=>Qe({id:i.id||"",href:fe(`/watch?v=${i.id}`),title:i.title||"",author:i.author||"",duration:i.duration||"",channelUrl:i.channelUrl||""}),t)}}async function xe(e,t=""){var s;const n=document.createDocumentFragment();if(e){const o=T(),a=o[decodeURI(e)];if(!a){alert("No items found");return}if(e==="discover")for(const r in a)a[r].frequency<2&&((s=o.discover)==null||delete s[r]);if(q(o),ft(a,n),!n.childElementCount){alert("No items found");return}l.list.id=e}else oe.className="publicPlaylist",k.showModal(),await fetch(`${location.origin}/public?id=${t}`).then(o=>o.json()).then(o=>{ft(o,n)}).catch(()=>$("Failed to load the shared list, it may consist of a corrupted stream")).finally(()=>k.close());y.innerHTML="",y.appendChild(n);const i=y.classList.contains("reverse");e&&We.includes(e)?i||y.classList.add("reverse"):i&&y.classList.remove("reverse"),oe.className=y.classList.contains("reverse")?"reserved":e?"collection":"publicCollection",location.pathname!=="/list"&&ee("/list"),Ct.scrollTo(0,0),history.replaceState({},"",location.origin+location.pathname+(e?"?collection="+e:"?si="+t)),document.title=(e||"Shared Playlist")+" - flyingdarkfox"}async function jt(e){const t=T(),n=()=>fetch("https://github.com/FlyingDarkFox/DarkFox/blob/beta/README.md").then(r=>r.text()).then(r=>r.split(`
`)).then(r=>{const c=[];for(let u=0;u<r.length;u+=4)c.push({type:"playlist",name:r[u+1],uploaderName:"YouTube Music",url:"/playlist?list="+r[u+2],thumbnail:"/"+r[u+3]});return R(c)});function i(){const r=document.createDocumentFragment(),c=Object.keys(t).filter(u=>!We.includes(u));return c.forEach(u=>{const d=le("a");d.href="/list?collection="+u,d.className="ur_cls_item";const m=le("i");m.className="ri-play-list-2-fill",d.append(m,u),r.appendChild(d)}),c.length?r:"No Collections Found"}function s(r){let c=!1,u=!1;if(r==="albums"&&(c=!0,r="playlists"),r==="artists"&&(u=!0,r="channels"),!Object(t).hasOwnProperty(r))return`No Subscribed ${r} Found`;const d=[],m=t[r];for(const h in m){let g=m[h].name;if(c){if(!g.startsWith("Album"))continue;g=g.slice(8)}else if(g.startsWith("Album"))continue;if(u){if(!g.startsWith("Artist"))continue;g=g.slice(8)}else if(g.startsWith("Artist"))continue;d.push({type:r.slice(0,-1),name:g,uploaderName:m[h].uploader,url:`/${r==="channels"?r.slice(0,-1):r}/`+m[h].id,thumbnail:m[h].thumbnail})}return d.length?R(d):`No Subscribed ${r} Found`}async function o(){if(!Object(t).hasOwnProperty("channels"))return"You have not subscribed to any channels";k.showModal();const r=Object.keys(t.channels).join(","),c=await fetch(ae("piped")+"/feed/unauthenticated?channels="+r).then(u=>u.json()).catch(u=>{Ke(u.message,o,()=>"")}).finally(()=>k.close());return R(c)}document.getElementById("superCollectionList").replaceChildren(e==="featured"?await n():e==="collections"?i():e==="feed"?await o():s(e))}async function Ve(e){const t=r=>fetch(`${r}/streams/${e}`).then(c=>c.json()).then(c=>{if(c&&"audioStreams"in c)return l.api.index=l.api.piped.indexOf(r),c;throw new Error(c.message)}),n=r=>fetch(`${r}/api/v1/videos/${e}`).then(c=>c.json()).then(c=>{if(c&&"adaptiveFormats"in c)return l.api.index=l.api.invidious.indexOf(r),c;throw new Error(c.error)}).then(c=>({title:c.title,uploader:c.author,duration:c.lengthSeconds,uploaderUrl:c.authorUrl,category:c.genre||"non-music",liveStream:c.liveNow,subtitles:[],relatedStreams:c.recommendedVideos.map(u=>({url:"/watch?v="+u.videoId,title:u.title,uploaderName:u.author,duration:u.lengthSeconds,uploaderUrl:u.authorUrl,type:"stream"})),audioStreams:c.adaptiveFormats.filter(u=>u.type.startsWith("audio")).map(u=>({bitrate:parseInt(u.bitrate),codec:u.encoding,contentLength:u.clen,quality:Math.floor(parseInt(u.bitrate)/1024)+" kbps",mimeType:u.type,url:u.url.replace(new URL(u.url).origin,r)}))})),i=l.player.HLS,s=l.api.invidious,o=l.api.piped,a=await Promise.any(o.filter((r,c)=>c<(i?o.length:l.api.unified)).map(t)).catch(()=>i?{}:Promise.any(s.map(n)).catch(()=>{l.stream.id===e&&(E.classList.replace(E.className,"ri-stop-circle-fill"),$("Could not retrieve stream data in any ways.. Trying again.."))}));return a||Ve(e)}async function K(e=""){var n;if(!e)return;E.classList.replace(E.className,"ri-loader-3-line");const t=await Ve(e);if(t&&"audioStreams"in t)l.player.data=t;else return K(e);if(await dn({id:e,title:t.title,author:t.uploader,duration:Te(t.duration),channelUrl:t.uploaderUrl}),l.player.legacy)f.src=t.hls,f.load();else{const i=l.player.HLS;i?i.loadSource(t.hls):O(()=>import("./setAudioStreams-DO6WpFIv.js"),[]).then(s=>s.setAudioStreams(t.audioStreams.sort((o,a)=>parseInt(o.bitrate)-parseInt(a.bitrate)),t.category==="Music",t.livestream))}O(()=>import("./setSubtitles-2Y7jyE77.js"),[]).then(i=>i.setSubtitles(t.subtitles)),x.set("s",e),location.pathname==="/"&&history.replaceState({},"",location.origin+"?s="+x.get("s")),w("enqueueRelatedStreams")==="on"&&O(()=>import("./enqueueRelatedStreams-D6hSsOZB.js"),[]).then(i=>i.enqueueRelatedStreams(t.relatedStreams)),z.checked&&(z.checked=!1,De.classList.remove("ri-heart-fill")),(n=T().favorites)!=null&&n.hasOwnProperty(e)&&(z.checked=!0,De.classList.add("ri-heart-fill")),w("discover")!=="off"&&O(()=>import("./setDiscoveries-Ba7qfhcd.js"),[]).then(i=>{setTimeout(()=>{i.setDiscoveries(e,t.relatedStreams)},1e5)})}var Tn=de("<img>"),_n=de("<a><div><p class=title></p><p class=uData></p><p class=stats>");function $n(e,t,n,i,s){const[o,a]=_t(n),r=l.loadImage==="off"?void 0:l.loadImage;function c(d){d.target.parentElement.classList.remove("ravel"),a("/logo192.png")}function u(d){d.target.parentElement.classList.remove("ravel")}return(()=>{var d=_n(),m=d.firstChild,h=m.firstChild,g=h.nextSibling,te=g.nextSibling;return qe(d,"listItem "+(r?"ravel":"")),S(d,"data-title",e),S(d,"data-url",s),S(d,"data-thumbnail",n),S(d,"data-uploader",i),_(d,qt(Ft,{when:r,get children(){var F=Tn();return F.addEventListener("load",u),F.addEventListener("error",c),S(F,"loading",r),W(()=>S(F,"src",o())),F}}),m),_(h,e),_(g,i),_(te,t),W(()=>S(d,"href",fe(s))),d})()}async function ke(e,t=!1){var u;if(!e)return $("No Channel URL provided");k.showModal();const n=!t&&(l.actionsMenu.author.endsWith(" - Topic")||l.list.name.startsWith("Artist"));if(n&&(e=await Pn(e)||"",!e)){k.close();return}const i=ae("piped"),s=await fetch(i+e).then(d=>d.json()).catch(d=>{Ke(t?"No Mixes Found":d.message,()=>ke(e,t),()=>"")}).finally(()=>k.close());if(!((u=s==null?void 0:s.relatedStreams)!=null&&u.length))return;y.classList.contains("reverse")&&y.classList.remove("reverse"),y.innerHTML="",y.appendChild(R(s.relatedStreams)),location.pathname!=="/list"&&ee("/list"),Ct.scrollTo(0,0);let o=s.nextpage;function a(d){new IntersectionObserver((m,h)=>m.forEach(async g=>{g.isIntersecting&&(o=await d(),h.disconnect(),o&&a(d))})).observe(y.children[y.childElementCount-3])}!t&&o&&a(async()=>{const d=await fetch(i+"/nextpage/"+e.substring(1)+"?nextpage="+encodeURIComponent(o)).then(h=>h.json()).catch(h=>console.log(h));if(!d)return;const m=[];return y.querySelectorAll(".streamItem").forEach(h=>{m.push(h.dataset.id)}),y.appendChild(R(d.relatedStreams.filter(h=>!m.includes(h.url.slice(-11))))),d.nextpage});const r=e.includes("channel")?"channel":"playlist";oe.className=r,kt.firstElementChild.dataset.state=" "+s.name,n||(l.list.name=s.name,l.list.url=e,l.list.id=e.slice(r==="playlist"?11:9),l.list.thumbnail=l.list.thumbnail||s.avatarUrl||s.thumbnail||s.relatedStreams[0].thumbnail,l.list.type=r+"s");const c=Object(T());je.firstElementChild.dataset.state=c.hasOwnProperty(l.list.type)&&c[l.list.type].hasOwnProperty(l.list.id)?" Subscribed":" Subscribe",t?xt.click():(l.list.url=e.replace("ts/","t?list="),document.title=s.name+" - flyingdarkfox",history.replaceState({},"",location.origin+location.pathname+"?"+e.split("/").join("=").substring(1)))}y.addEventListener("click",Ye);const Pn=e=>fetch(l.api.hyperpipe+e).then(t=>t.json()).then(t=>{var n,i,s;if(!("playlistId"in t))throw new Error("No Playlist Id found.");return l.list.id=e.slice(9),l.list.type="channels",l.list.thumbnail=l.list.thumbnail||"/a-"+((s=(i=(n=t.thumbnails[0])==null?void 0:n.url)==null?void 0:i.split("/a-")[1])==null?void 0:s.split("=")[0]),"/playlists/"+t.playlistId}).catch(t=>($(t.message),"")),le=document.createElement.bind(document),Be=localStorage.setItem.bind(localStorage),Ae=localStorage.removeItem.bind(localStorage),ee=e=>document.getElementById(e).click(),ae=(e,t=l.api.index)=>l.api[e][t],Nn=e=>{var t;return(t=e==null?void 0:e.match(/(https?:\/\/)?((www\.)?(youtube(-nocookie)?|youtube.googleapis)\.com.*(v\/|v=|vi=|vi\/|e\/|embed\/|user\/.*\/u\/\d+\/)|youtu\.be\/)([_0-9a-z-]+)/i))==null?void 0:t[7]},On=e=>e.includes("=")?"playlists="+e.split("=")[1]:e.slice(1).split("/").join("="),fe=e=>l.linkHost+(l.linkHost.includes(location.origin)?e.startsWith("/watch")?"?s"+e.slice(8):"/list?"+On(e):e);async function di(){if(!l.stream.id)return;l.player.playbackState==="playing"&&f.pause();const e=f.currentTime;await K(l.stream.id),f.currentTime=e,f.play()}function $(e){const t=le("p"),n=()=>document.getElementsByClassName("snackbar")[0]&&t.remove();t.className="snackbar",t.textContent=e,t.onclick=n,setTimeout(n,8e3),document.body.appendChild(t)}function Te(e){if(e<0)return"";const t=Math.floor(e/3600);e%=3600;const n=Math.floor(e/60),i=Math.floor(e%60);let s=String(n),o=String(i);return n<10&&(s="0"+s),i<10&&(o="0"+o),(t>0?t+":":"")+`${s}:${o}`}async function Ke(e,t,n){if(e!=="nextpage error"){if(e!=="No Data Found"&&l.api.index<l.api.unified-1){l.api.index++,t();return}$(e),n(),l.api.index=0}}function R(e){if(!(e!=null&&e.length))throw new Error("No Data Found");const t=o=>Intl.NumberFormat("en",{notation:"compact"}).format(o),n=o=>Qe({id:o.videoId||o.url.substring(9),href:fe(o.url||"/watch?v="+o.videoId),title:o.title,author:(o.uploaderName||o.author)+(location.search.endsWith("music_songs")?" - Topic":""),duration:(o.duration||o.lengthSeconds)>0?Te(o.duration||o.lengthSeconds):"LIVE",uploaded:o.uploadedDate||o.publishedText,channelUrl:o.uploaderUrl||o.authorUrl,views:o.viewCountText||(o.views>0?t(o.views)+" views":""),img:ye(o.thumbnail||"https://i.ytimg.com/vi_webp/"+o.videoId+"/mqdefault.webp?host=i.ytimg.com")}),i=o=>$n(o.name,o.subscribers>0?t(o.subscribers)+" subscribers":o.videos>0?o.videos+" streams":"",Me(ye(o.thumbnail),""),o.description||o.uploaderName,o.url),s=document.createDocumentFragment();for(const o of e)X(()=>o.type==="stream"||o.type==="video"?n(o):i(o),s);return s}async function Ye(e){const t=e.target;if(t.target==="_blank")return;e.preventDefault();const n=t.dataset,i=t.classList.contains.bind(t.classList);if(i("streamItem"))return i("delete")?Ut(l.list.id,n.id):K(n.id);if(i("ur_cls_item"))xe(t.textContent);else if(i("ri-more-2-fill")){se.showModal(),history.pushState({},"","#");const s=t.parentElement.dataset,o=l.actionsMenu;o.id=s.id,o.title=s.title,o.author=s.author,o.channelUrl=s.channel_url,o.duration=s.duration}else if(i("listItem")){l.actionsMenu.author="";let s=n.url;s.startsWith("/channel")||(s=s.replace("?list=","s/")),l.list.name=(location.search.endsWith("music_artists")||location.pathname==="/library"&&w("defaultSuperCollection")==="artists"?"Artist - ":"")+n.title,l.list.uploader=n.uploader,l.list.thumbnail=n.thumbnail?ye(n.thumbnail):"",ke(s)}}const[Dn,qn,Z,Ue,pe]=document.getElementById("queuetools").children,Le=()=>C.firstElementChild;function Ge(e,t=!1){var i;if(!e.id||l.queue.includes(e.id)||Ue.classList.contains("filter")&&Ht(e.duration))return;(i=Le())!=null&&i.matches("h1")&&Le().remove(),Z.classList.contains("delete")&&Z.click(),t?l.queue.unshift(e.id):l.queue.push(e.id);const n=document.createDocumentFragment();X(()=>Qe({id:e.id||"",title:e.title||"",author:e.author||"",duration:e.duration||"",draggable:!0}),n),t?C.prepend(n):C.appendChild(n)}C.addEventListener("click",e=>{e.preventDefault();const t=e.target;if(!t.classList.contains("streamItem"))return;const n=t.dataset.id||"";function i(){const o=sessionStorage.getItem("trashHistory")||"";o!=null&&o.includes(n)||sessionStorage.setItem("trashHistory",o+n)}t.classList.contains("delete")?i():K(n);const s=l.queue.indexOf(n);l.queue.splice(s,1),C.children[s].remove()});function mt(e){e.querySelectorAll(".streamItem").forEach(n=>{Ge(n.dataset)}),ee("/upcoming")}function Mt(){l.queue.length=0,C.innerHTML=""}Dn.addEventListener("click",Mt);qn.addEventListener("click",()=>{for(let e=C.children.length;e>=0;e--)C.appendChild(C.children[Math.random()*e|0]);l.queue.length=0;for(const e of C.children)l.queue.push(e.dataset.id||"")});Z.addEventListener("click",()=>{C.querySelectorAll(".streamItem").forEach(e=>{e.classList.toggle("delete")}),Z.classList.toggle("delete")});Ue.addEventListener("click",()=>{Ue.classList.toggle("filter"),Z.classList.contains("delete")&&Z.click(),C.querySelectorAll(".streamItem").forEach(t=>{const n=t.dataset.duration;Ht(n)&&(t.classList.add("delete"),t.click())})});pe.addEventListener("click",()=>{pe.classList.contains("checked")?Ae("enqueueRelatedStreams"):Be("enqueueRelatedStreams","on"),pe.classList.toggle("checked")});w("enqueueRelatedStreams")==="on"&&(pe.className="checked");function Ht(e){const t=e.split(":");return!(t.length===2&&parseInt(t[0])<10)}new MutationObserver(e=>{for(const t of e)if(t.type==="childList"){const n=l.queue.join("");l.upcomingQuery=n,location.pathname==="/upcoming"&&history.replaceState({},"",location.pathname+(n?`?a=${n}`:""))}}).observe(C,{childList:!0});let Re=b;l.loadImage==="off"&&(b.remove(),Re="");Oe.addEventListener("click",e=>{e.preventDefault(),e.target.matches("button")||ee("/")});const ht=document.getElementById("mptext");function Fn(e,t){e?(t.add("hide"),document.getElementById("upperLayer").prepend(Re),document.getElementById("meta").prepend(ge,Ne),document.getElementById("playerControls").insertBefore(E,document.getElementById("seekFwdButton"))):t.contains("hide")&&(t.remove("hide"),Oe.prepend(Re),ht.append(ge,Ne),Oe.lastElementChild.append(ht,E))}const Qt=document.querySelector("nav"),pt=document.querySelectorAll("nav a"),gt=document.querySelectorAll("section"),Je=["/","/upcoming","/search","/library","/settings","/list"],yt=x.get("a");function Wt(e){k.showModal(),fetch(`${location.origin}/public?id=${e}`).then(t=>t.json()).then(t=>{for(const n of t)Ge(n)}).finally(()=>k.close())}yt&&Wt(yt);let me=Je.indexOf(location.pathname);function Vt(e){const t=Je.indexOf(e);Fn(e==="/",Qt.parentElement.classList),e==="/library"&&jt(w("defaultSuperCollection")||"featured"),gt[t].classList.add("view");const n=pt[t];n.classList.add("active");const i=n.firstElementChild.classList;if(i.length&&i.replace(i[0],i[0].replace("line","fill")),me!==t){gt[me].classList.remove("view");const s=pt[me];s.classList.remove("active");const o=s.firstElementChild.classList;o.length&&o.replace(o[0],o[0].replace("fill","line"))}me=t}Qt.addEventListener("click",e=>{var i;e.preventDefault();const t=e.target;if(!t.matches("a"))return;const n=t.id==="/";if(t.id!==location.pathname){const s=x.has("s")&&n,o="?s="+x.get("s"),a=l.upcomingQuery?"?a="+l.upcomingQuery:"",r=t.id==="/search"?l.searchQuery:t.id==="/upcoming"?a:"";history.pushState({},"",t.id+(s?o:r));const c=(i=t.lastElementChild)==null?void 0:i.textContent,u=l.stream.title||"Home";document.title=(n?u:c)+" - FlyingDarkDev"}Vt(t.id)});let P;const he=x.get("e");if(he)if(he.includes("?")){const e=he.split("?");P=e[0];const t=encodeURI(e[1]);if(P==="/list"&&(t.startsWith("si")?xe("",t.split("=")[1]):ke("/"+t.split("=").join("/"))),P==="/search"){const n=new URLSearchParams(t);A.value=n.get("q")||"",J.value=n.get("f")||"all",A.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter"}))}P==="/upcoming"&&Wt(t.slice(2))}else P=he;else{P=Je.find(t=>location.pathname===t)||"/";const e=x.has("s")||x.has("url")||x.has("text");P==="/"&&!e&&(P=w("startupTab")||"/search")}ee(P);onpopstate=function(){if(se.open){se.close();return}if(!l.list.id&&location.pathname==="/list"){const e=location.search.substring(1).split("=");location.search.includes("collection")?xe(e[1]):ke("/"+e.join("/"))}Vt(location.pathname)};const ne=document.getElementById("playSpeed"),Un=document.getElementById("seekBwdButton"),Rn=document.getElementById("seekFwdButton"),jn=document.getElementById("currentDuration"),Mn=document.getElementById("fullDuration"),Hn=document.getElementById("playPrevButton"),Qn=document.getElementById("playNextButton"),vt=document.getElementById("loopButton"),H=document.getElementById("volumeChanger"),G=H.previousElementSibling,Kt="mediaSession"in navigator;function M(){Kt&&"setPositionState"in navigator.mediaSession&&navigator.mediaSession.setPositionState({duration:f.duration,playbackRate:f.playbackRate,position:f.currentTime})}E.onclick=function(){l.stream.id&&(l.player.playbackState==="playing"?f.pause():f.play())};let Yt="",ze=0;f.onplaying=function(){E.classList.replace(E.className,"ri-pause-circle-fill"),l.player.playbackState="playing";const e=l.stream.id;if(l.streamHistory.includes(e)||l.streamHistory.push(e),w("history")==="off")return;const t=kn("history").firstElementChild;(t==null?void 0:t.dataset.id)!==e&&(ze=window.setTimeout(()=>{Yt===e&&(Rt("history",l.stream),tn.classList.contains("view")&&x.get("collection")==="history"&&ee("history"))},1e4))};f.onpause=function(){E.classList.replace("ri-pause-circle-fill","ri-play-circle-fill"),l.player.playbackState="paused",clearTimeout(ze)};let Gt=!1;const Wn=setInterval(()=>{(l.streamHistory.length||x.has("url")||x.has("text")||!x.has("s"))&&(Gt=!0,clearInterval(Wn))},500);f.onloadeddata=function(){E.classList.replace("ri-loader-3-line","ri-play-circle-fill"),Gt&&f.play(),Yt=l.stream.id,clearTimeout(ze),ne.value!=="1.00"&&(f.playbackRate=parseFloat(ne.value))};f.onwaiting=function(){E.classList.replace(E.className,"ri-loader-3-line")};ne.onchange=function(){const e=parseFloat(ne.value);e<0||e>4||(f.playbackRate=e,M(),ne.blur())};Rn.onclick=function(){f.currentTime+=15,M()};Un.onclick=function(){f.currentTime-=15,M()};U.onchange=function(){const e=parseInt(U.value);e<0||e>f.duration||(f.currentTime=e,U.blur())};f.ontimeupdate=function(){if(U===document.activeElement)return;const e=Math.floor(f.currentTime);U.value=e.toString(),jn.textContent=Te(e)};f.onloadedmetadata=function(){U.value="0",U.min="0",U.max=Math.floor(f.duration).toString(),Mn.textContent=Te(f.duration)};f.oncanplaythrough=function(){const e=l.queue[0];e&&Ve(e)};f.onerror=function(){if(f.pause(),w("custom_instance_2"))return $("Proxy failed to decrypt stream");if(l.player.HLS||w("proxyViaInvidious")==="false"){$("PipedProxy failed to decrypt stream, Retrying..."),K(l.stream.id);return}const e=new URL(f.src).origin,t=new URL(l.player.data.audioStreams[0].url).origin,n="https://flyingdarkfox.netlify.app/";e===t?(E.classList.replace(E.className,"ri-stop-circle-fill"),$("Could not play stream in any ways..")):f.src=f.src.replace(e,e===n?t:n)};vt.onclick=function(){vt.classList.toggle("on"),f.loop=!f.loop};Hn.onclick=function(){l.streamHistory.length>1&&(Ge(l.stream,!0),l.streamHistory.pop(),K(l.streamHistory[l.streamHistory.length-1]))};function Jt(){E.classList.replace(E.className,"ri-stop-circle-fill"),C.childElementCount&&Le().click()}f.onended=Qn.onclick=Jt;G.onclick=function(){H.value=f.volume?"0":"100",f.volume=f.volume?0:1,G.classList.replace(G.className,`ri-volume-${G.className.includes("mute")?"up":"mute"}-fill`)};H.oninput=function(){f.volume=parseFloat(H.value)/100,f.volume===1?Ae("volume"):Be("volume",H.value),G.classList.replace(G.className,f.volume?`ri-volume-${f.volume>.5?"up":"down"}-fill`:"ri-volume-mute-fill")};const bt=w("volume");bt&&(H.value=bt,f.volume=parseFloat(H.value)/100);Kt&&(navigator.mediaSession.setActionHandler("play",()=>{f.play()}),navigator.mediaSession.setActionHandler("pause",()=>{f.pause()}),navigator.mediaSession.setActionHandler("seekforward",()=>{f.currentTime+=15,M()}),navigator.mediaSession.setActionHandler("seekbackward",()=>{f.currentTime-=15,M()}),navigator.mediaSession.setActionHandler("seekto",e=>{f.currentTime=e.seekTime||0,M()}),navigator.mediaSession.setActionHandler("nexttrack",()=>{Jt(),M()}));function Vn(e){const t=l.list,n=[" Subscribe"," Subscribed"],i=je.firstElementChild;if(i.dataset.state===n[1])delete e[t.type][t.id],n.reverse();else{const o={id:t.id,name:t.name,thumbnail:ye(t.thumbnail)};t.type==="playlists"&&(o.uploader=t.uploader),Ce(t.type,o,e)}i.dataset.state=n[1],q(e)}function Kn(){const e=prompt("Set Title",l.list.name);if(!e)return;An(e);const t={};y.querySelectorAll(".streamItem").forEach(n=>{const i=n.dataset,s=i.id;t[s]={id:i.id,title:i.title,author:i.author,duration:i.duration,channelUrl:i.channel_url}}),Bn(e,t),$(e+" has been imported to your collections.")}function Yn(e){const t=location.origin+location.pathname+"?si="+e,n="text/plain",i=new Blob([t],{type:n}),s=[new ClipboardItem({[n]:i})];navigator.clipboard.write(s)}oe.addEventListener("click",async e=>{var o;const t=e.target;if(!t.matches("button"))return;const n=T(),i=l.list.id,s=document.getElementById("collectionSelector").querySelector(`[value="${i}"]`);if(t===xt)Mt(),mt(y),Le().click();else if(t===nn)mt(y);else if(t===kt)open(["https://youtube.com",location.origin].includes(l.linkHost)?"https://youtube.com"+l.list.url:fe(l.list.url));else if(t===je)Vn(n);else if(t===at)y.querySelectorAll(".streamItem").forEach(a=>a.classList.toggle("delete")),at.classList.toggle("delete");else if(t===sn)Kn();else if(t===rn){if(!n||!confirm("Are you sure you want to delete the collection  "+i+" ?"))return;s.remove(),delete n[i],q(n),history.back()}else if(t===on){if(!confirm("Are you sure you want to clear "+i+" ?"))return;delete n[i],q(n),y.innerHTML=""}else if(t===ln){const a=(o=prompt("Enter the new title",i))==null?void 0:o.trim();if(!a)return;s.text=a,s.value=a,n[a]=n[i],delete n[i],q(n)}else t===an&&Yn(Object.keys(n[i]).join(""))});const Gn=(e,t="")=>t==="date"||t==="views"?Xt(ae("invidious"),e,t):Xn(ae("piped"),e);let ie="",zt,Pe=1;function Xe(e){const t=Q.childElementCount;new IntersectionObserver((n,i)=>n.forEach(async s=>{s.isIntersecting&&(i.disconnect(),ie=await e()||"null",ie!=="null"&&Xe(e))})).observe(Q.children[t-(t>5?5:1)])}function Jn(e){return Pe=e===zt?Pe+1:1,Pe}const Xt=(e,t,n)=>fetch(`${e}/api/v1/search?q=${t}&sort=${n}&page=${Jn(t)}`).then(i=>i.json()).then(i=>{Q.appendChild(R(i.filter(s=>s.lengthSeconds>62&&s.viewCount>1e3))),zt=t,Xe(()=>Xt(e,t,n))}),zn=(e,t,n)=>fetch(`${e}/nextpage/search?nextpage=${encodeURIComponent(t)}&${n}`).then(i=>i.json()).catch(i=>console.log("e:"+i)),Xn=(e,t)=>fetch(e+"/"+t).then(n=>n.json()).then(async n=>{const i=n.items;if(ie=n.nextpage,!i)throw new Error("No Items Found");Q.appendChild(R(i==null?void 0:i.filter(s=>!s.isShort))),ie!=="null"&&Xe(async()=>{var o;const s=await zn(e,ie,t.substring(7));return Q.appendChild(R((o=s.items)==null?void 0:o.filter(a=>!a.isShort&&a.duration!==-1))),s.nextpage})}),B=document.getElementById("suggestions");function _e(){const e="?q="+A.value,t="&filter="+J.value,n="search"+e+t,i=J.selectedIndex>8;if(l.searchQuery=e+(t.includes("all")?"":t),Q.innerHTML="",!A.value){history.replaceState({},"",location.origin+location.pathname);return}k.showModal(),Gn(i?A.value:n,J.value).catch(s=>{i||s.message==="nextpage error"||Ke(s.message,_e,()=>"")}).finally(()=>k.close()),history.replaceState({},"",location.origin+location.pathname+l.searchQuery.replace("filter","f")),B.style.display="none"}let wt;A.addEventListener("input",async()=>{const e=A.value,t=Nn(e);if(t!==wt){K(t),wt=t;return}if(w("search_suggestions")||(B.innerHTML="",B.style.display="none",e.length<3))return;B.style.display="block";const n=(await fetch(ae("piped")+"/opensearch/suggestions/?query="+e).then(s=>s.json()))[1];if(!n.length)return;const i=document.createDocumentFragment();for(const s of n){const o=le("li");o.textContent=s,o.onclick=()=>{A.value=s,_e()},i.appendChild(o)}B.appendChild(i),N=0});let N=0;A.addEventListener("keydown",e=>{if(e.key==="Enter"&&(_e(),e.preventDefault()),!(e.key==="Backspace"||w("search_suggestions")||!B.hasChildNodes())){if(B.childNodes.forEach(t=>{t.classList.contains("hover")&&t.classList.remove("hover")}),e.key==="ArrowUp"){N===0&&(N=B.childElementCount),N--;const t=B.children[N];A.value=t.textContent,t.classList.add("hover")}if(e.key==="ArrowDown"){const t=B.children[N];A.value=t.textContent,t.classList.add("hover"),N++,N===B.childElementCount&&(N=0)}}});document.addEventListener("keydown",e=>{e.ctrlKey&&e.key==="K"&&A.focus()});Q.addEventListener("click",Ye);J.addEventListener("change",_e);w("searchSuggestions")&&B.remove();const Et=w("searchFilter");Et&&(J.value=Et);const St=document.getElementById("upload"),Zn=document.getElementById("exportBtn"),ei=document.getElementById("cleanLibraryBtn"),ti=document.getElementById("collections"),ni=document.getElementById("superCollectionList");St.addEventListener("change",async()=>{const e=JSON.parse(await St.files[0].text()),t=T();if(confirm("This will merge your current library with the imported library, continue?")){for(const n in e)for(const i in e[n])Ce(n,e[n][i],t);q(t),location.reload()}});Zn.addEventListener("click",()=>{const e=le("a");e.download="flyingdarkfox_library.json",e.href=`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(T(),void 0,2))}`,e.click()});ei.addEventListener("click",()=>{confirm(`Are you sure you want to clear ${Object.values(T()).reduce((e,t)=>e+Object.keys(t).length,0)} items from the library?`)&&(Ae("library"),location.reload())});z.addEventListener("click",()=>{l.stream.id&&(z.checked?Rt("favorites",l.stream):Ut("favorites",l.stream.id),De.classList.toggle("ri-heart-fill"))});ti.addEventListener("click",e=>{e.preventDefault();const t=e.target;t.classList.contains("collectionItem")&&xe(t.id)});cn.addEventListener("click",e=>{const t=e.target;t.value&&(t.value==="featured"?Ae("defaultSuperCollection"):Be("defaultSuperCollection",t.value),jt(t.value))});const Lt=w("defaultSuperCollection");var It;Lt&&((It=document.getElementById("r."+Lt))==null||It.toggleAttribute("checked"));ni.addEventListener("click",Ye);addEventListener("DOMContentLoaded",async()=>{const e=document.getElementById("settings");await O(()=>import("./Settings-Bb0B-BkV.js"),__vite__mapDeps([0,1])).then(t=>X(t.default,e)),e.appendChild(document.getElementById("actionsContainer")),await O(()=>import("./start-BQDXwqsJ.js"),[]).then(t=>t.default()),await O(()=>import("./ActionsMenu-DwPXa-7R.js"),__vite__mapDeps([2,3])).then(t=>X(t.default,se)),await O(()=>import("./virtual_pwa-register-Ctw5HrMg.js"),[]).then(t=>{const n=t.registerSW({onNeedRefresh(){O(()=>import("./UpdatePrompt-C0lvHntI.js"),__vite__mapDeps([4,5])).then(i=>X(()=>i.default(n),document.body))}})})});export{le as $,A,J as B,xe as C,ke as D,C as E,An as F,Rt as G,We as H,se as I,Ge as J,kt as K,_t as L,ct as M,E as N,li as O,ri as P,oi as Q,Te as R,Ft as S,Bn as T,tn as U,ee as V,O as _,w as a,Be as b,qt as c,ci as d,b as e,f,Me as g,T as h,_ as i,q as j,ui as k,W as l,S as m,si as n,ai as o,$ as p,di as q,Ae as r,l as s,de as t,Sn as u,K as v,x as w,Nn as x,k as y,ii as z};
