import{s as l,h as a,R as d,T as h,U as f,w as u,V as v}from"./index-wmVoKqK-.js";function y(c,t){if(c!==l.stream.id)return;const e=a();e.hasOwnProperty("discover")||(e.discover={}),t==null||t.forEach(o=>{var n;if(o.type!=="stream"||o.duration<100||o.duration>3e3)return;const r=o.url.slice(9);(n=e.discover)!=null&&n.hasOwnProperty(r)?e.discover[r].frequency++:e.discover[r]={id:r,title:o.title,author:o.uploaderName,duration:d(o.duration),channelUrl:o.uploaderUrl,frequency:1}});let i=Object.entries(e.discover);for(let o=i.length-1;o>0;o--){const r=Math.floor(Math.random()*(o+1));[i[o],i[r]]=[i[r],i[o]]}i=i.filter(o=>{var r;return!((r=e.history)!=null&&r.hasOwnProperty(o[0]))});let s=i.length;for(;s>256;){const o=Math.floor(Math.random()*s);i.splice(o,1),s--}e.discover={},h("discover",Object.fromEntries(i),e),f.classList.contains("view")&&u.get("collection")==="discover"&&v("discover")}export{y as setDiscoveries};
