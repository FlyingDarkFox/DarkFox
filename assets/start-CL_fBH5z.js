import{a as y,n as o,s as n,_ as g,f as i,p as v,v as m,w as t,x,y as _,z as I,A as E,B as L,C as S,D as R,E as U}from"./index-BvXPlkwh.js";async function k(){var d;const r=y("custom_instance_2"),s=n.api;if(r){const[a,e]=r.split(",");s.piped.push(a),s.invidious.push(e)}else await fetch("https://raw.githubusercontent.com/n-ce/Uma/main/dynamic_instances.json").then(e=>e.json()).then(e=>{s.piped=e.piped,s.invidious=e.invidious,s.unified=e.unified});y("HLS")?(o.remove(),n.player.legacy||g(()=>import("./hls-BdzRFHu8.js"),[]).then(a=>{n.player.HLS=new a.default;const e=n.player.HLS;e.attachMedia(i),e.on(a.default.Events.MANIFEST_PARSED,()=>{e.currentLevel=n.player.hq?e.levels.findIndex(l=>l.audioCodec==="mp4a.40.2"):0,i.play()}),e.on(a.default.Events.ERROR,(l,p)=>{if(p.details==="manifestLoadError"){const u=n.player.data.hls,f=new URL(u).origin,h="https://flyingdarkfox.netlify.app/";if(f===h){v(p.details);return}const w=u.replace(f,h);e.loadSource(w)}else v("load error, retrying..."),m(n.stream.id)})})):o.addEventListener("change",()=>{n.player.playbackState==="playing"&&i.pause();const a=i.currentTime;i.src=o.value,i.currentTime=a,i.play()});const c=t.get("s")||x(t.get("url")||t.get("text"));c?(_.showModal(),await m(c),_.close()):(d=document.getElementById("flyingdarkfoxIconContainer"))==null||d.prepend(I),t.has("q")&&(E.value=t.get("q")||"",t.has("f")&&(L.value=t.get("f")||""),E.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter"}))),(t.has("collection")||t.has("si"))&&S(t.get("collection"),t.get("si")),(t.has("channel")||t.has("playlists"))&&R("/"+location.search.substring(1).split("=").join("/")),await g(()=>import("./sortable.esm-BhoLyUOZ.js"),[]).then(a=>new a.default(U,{handle:".ri-draggable",onUpdate(e){if(e.oldIndex==null||e.newIndex==null)return;const l=n.queue;l.splice(e.newIndex,0,l.splice(e.oldIndex,1)[0])}}))}export{k as default};
